/*! FuzzyJS - v0.1.0 - 2014-03-14
* https://github.com/alocay/FuzzyJS
* Copyright (c) 2014 Armando Locay; Licensed MIT */
!function(a){"use strict";function b(a){o=l.width=a.width,p=l.height=a.height,m.drawImage(a,0,0,o,p)}function c(a){var b,c;o=l.width=a.width,p=l.height=a.height,q=a,b=q.getContext("2d"),c=b.getImageData(0,0,o,p),m.putImageData(c,0,0)}function d(b,c){var d=new a.Image,g=e(b,c);return d.width=g.width,d.height=g.height,d.src=f(d.width,d.height),d}function e(a,b){var c=a,d=b,e=a&&"number"==typeof a,f=b&&"number"==typeof b;return e&&!f?d=a!==l.width?a/l.width*l.height|0:l.height:f&&!e?c=b!==l.height?b/l.height*l.width|0:l.width:e||e||(c=l.width,d=l.height),{width:c,height:d}}function f(b,c){var d=l;return(b!==o||c!==p)&&(d=a.document.createElement("canvas"),d.width=b,d.height=c,d.getContext("2d").drawImage(l,0,0,b,c)),d.toDataURL()}function g(){var b=a.document.createElement("canvas");return b.width=l.width,b.height=l.height,b.getContext("2d").drawImage(l,0,0,l.width,l.height),b}function h(a){for(var b=0;b<n.data.length;b+=4){var c,d,e;switch(a){case r.colorFilters.RED:c=n.data[b],d=255-n.data[b+1],e=255-n.data[b+2];break;case r.colorFilters.GREEN:c=255-n.data[b],d=n.data[b+1],e=255-n.data[b+2];break;case r.colorFilters.BLUE:c=255-n.data[b],d=255-n.data[b+1],e=n.data[b+2];break;default:c=255-n.data[b],d=255-n.data[b+1],e=255-n.data[b+2]}n.data[b]=Math.min(255,Math.max(0,c)),n.data[b+1]=Math.min(255,Math.max(0,d)),n.data[b+2]=Math.min(255,Math.max(0,e))}}function i(a,b,c,d,e){for(var f=0,g=0,h=0,i=0,k=a;a+e>k&&c>k;k++)for(var l=b;b+e>l&&d>l;l++){var m=j(k,l);f+=m.r,h+=m.b,g+=m.g,i++}return f=f/i|0,g=g/i|0,h=h/i|0,{r:f,b:h,g:g,a:255}}function j(a,b){var c=4*(a+b*n.width);return{r:n.data[c+0],g:n.data[c+1],b:n.data[c+2],a:n.data[c+3]}}function k(a,b,c){var d=4*(a+b*n.width);n.data[d+0]=c.r,n.data[d+1]=c.g,n.data[d+2]=c.b,n.data[d+3]=c.a}var l,m,n,o,p,q,r=function(d){if(l=a.document.createElement("canvas"),m=l.getContext("2d"),d instanceof a.HTMLImageElement){if(!d.complete)throw"image must first be loaded (src: "+d.src+")";b(d)}else{if(!(d instanceof a.HTMLCanvasElement))return null;c(d)}return n=m.getImageData(0,0,o,p),r};r.colorFilters={RED:"red",GREEN:"green",BLUE:"blue",NONE:"none"},r.colorFilter=function(a){for(var b=0;b<n.data.length;b+=4){switch(a){case r.colorFilters.RED:n.data[b+1]=0,n.data[b+2]=0;break;case r.colorFilters.GREEN:n.data[b]=0,n.data[b+2]=0;break;case r.colorFilters.BLUE:n.data[b]=0,n.data[b+1]=0}}return this},r.invert=function(a){return h(a?a:r.colorFilters.NONE),this},r.greyscale=function(){for(var a=0;a<n.data.length;a+=4){var b=.299*n.data[a]+.587*n.data[a+1]+.114*n.data[a+2];n.data[a]=n.data[a+1]=n.data[a+2]=b}return this},r.pixelate=function(a){a=0>=a?1:a,a=a>=o?o-1:a;for(var b=0;o>b;b+=a)for(var c=0;o>c;c+=a){for(var d=a/2|0,e=a/2|0;b+d>=o;)d--;for(;c+e>=p;)e--;for(var f=j(b+d,c+e),g=b;b+a>g&&o>g;g++)for(var h=c;c+a>h&&p>h;h++)k(g,h,f)}return this},r.boxBlur=function(a){a=0>a?0:a;for(var b=0;o>b;b++)for(var c=0;p>c;c++)for(var d=i(b,c,o,p,a),e=b;b+a>e&&o>e;e++)for(var f=c;c+a>f&&p>f;f++)d.a=j(e,f).a,k(e,f,d);return this},r.draw=function(b,c){if(m.putImageData(n,0,0),c=c||{},b instanceof a.HTMLImageElement){var e=c.width||b.width,h=c.height||b.height,i=b.attributes.width,j=b.attributes.height;e=0>=e&&i?i.value:l.width,h=0>=h&&j?j.value:l.height,b.src=f(e,h)}if(c.overwrite===!0&&q&&q.getContext("2d").putImageData(n,0,0),c.callback&&"function"==typeof c.callback){var k=d(c.width,c.height);c.callback(k)}return g()},r.scale=function(a,b){return m.putImageData(n,0,0),d(a,b)},a.fuzzy=r}(this);